---
title: Decision Tree Classification
author: Adogbeji Agberien
date: '2021-04-25'
slug: []
categories: []
tags: []
subtitle: ''
summary: ''
authors: []
lastmod: '2021-04-25T16:16:09-04:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<p>This post is about Decision Tree Classification, currently just its implementation in R. Hopefully in the coming days I will include the theory of the method.</p>
<pre class="r"><code># Install and load packages
required_packages &lt;- c(&quot;tidyverse&quot;, &quot;data.table&quot;, 
                       &quot;caTools&quot;, &quot;e1071&quot;, &quot;rpart&quot;,
                       &quot;rmarkdown&quot;, &quot;knitr&quot;)

packageCheck &lt;- lapply(required_packages, FUN = function(x) {
  if(!require(x, character.only = TRUE)) {
    install.packages(x, dependencies = TRUE)
    library(x, character.only = TRUE)
  }
})</code></pre>
<pre class="r"><code>head(social_network_ads)</code></pre>
<pre><code>##     User ID Gender Age EstimatedSalary Purchased
## 1: 15624510   Male  19           19000         0
## 2: 15810944   Male  35           20000         0
## 3: 15668575 Female  26           43000         0
## 4: 15603246 Female  27           57000         0
## 5: 15804002   Male  19           76000         0
## 6: 15728773   Male  27           58000         0</code></pre>
<pre class="r"><code># Visualize the decision tree on the complete data 
social_network_ads[, c(&quot;Age&quot;)] &lt;- social_network_ads[, c(&quot;Age&quot;)] 
social_network_ads[, c(&quot;EstimatedSalary&quot;)] &lt;- social_network_ads[, c(&quot;EstimatedSalary&quot;)]

plot(rpart(as.factor(Purchased) ~ Age + EstimatedSalary, data = social_network_ads)) 
text(rpart(as.factor(Purchased) ~ Age + EstimatedSalary, data = social_network_ads))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code># Scale the data 
social_network_ads[, c(&quot;Age&quot;)] &lt;- social_network_ads[, c(&quot;Age&quot;)] %&gt;% scale()
social_network_ads[, c(&quot;EstimatedSalary&quot;)] &lt;- social_network_ads[, c(&quot;EstimatedSalary&quot;)] %&gt;% scale()</code></pre>
<pre class="r"><code># Split the data into training and test sets
set.seed(123)
data_split &lt;- sample.split(social_network_ads$Purchased, SplitRatio = 0.8)
training_set &lt;- subset(social_network_ads, data_split == T)
test_set &lt;- subset(social_network_ads, data_split == F)</code></pre>
<pre class="r"><code># Create the decision tree model
purchase_decision_tree &lt;- rpart(as.factor(Purchased) ~ Age + EstimatedSalary, data = social_network_ads)</code></pre>
<pre class="r"><code># Make a prediction on the test set
y_pred_test &lt;- predict(purchase_decision_tree, newdata = test_set[, !c(&quot;Purchased&quot;)], type = &quot;class&quot;)</code></pre>
<pre class="r"><code># Create the confusion matrix 
table(y_pred_test, test_set$Purchased)</code></pre>
<pre><code>##            
## y_pred_test  0  1
##           0 45  2
##           1  6 27</code></pre>
<pre class="r"><code># Create a grid for visualization
the_grid &lt;- expand.grid(seq(min(test_set$EstimatedSalary), max(test_set$EstimatedSalary), 0.01),
                        seq(min(test_set$Age), max(test_set$Age), 0.01)) %&gt;% data.table() %&gt;% 
  setnames(old = c(&quot;Var1&quot;, &quot;Var2&quot;), new = c(&quot;EstimatedSalary&quot;, &quot;Age&quot;))</code></pre>
<pre class="r"><code>y_grid_pred &lt;- predict(purchase_decision_tree, the_grid, type = &quot;class&quot;)</code></pre>
<pre class="r"><code>ggplot() +
  geom_point(aes(the_grid$EstimatedSalary, the_grid$Age, colour = as.factor(y_grid_pred), alpha = 0.2)) +
  geom_point(aes(test_set$EstimatedSalary, test_set$Age, colour = as.factor(test_set$Purchased)), colour = if_else(test_set$Purchased == 1, &quot;black&quot;, &quot;yellow&quot;)) +
  xlab(&quot;Salary&quot;) +
  ylab(&quot;Age&quot;) +
  ggtitle(&quot;Decision tree classifier used to determine purchase of an item based on age and salary.&quot;) +
  theme_classic() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
